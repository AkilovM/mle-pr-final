Яндекс Практикум, MLE, Спринт 6, Финальный проект.
-

Выбрал Кейс 1: Рекомендации банковских продуктов.

---

Скачиваем датасет:

```
mkdir dataset
cd dataset
wget https://getfile.dokpub.com/yandex/get/https://disk.yandex.com/d/Io0siOESo2RAaA
mv Io0siOESo2RAaA train_ver2.csv.zip
sudo apt install unzip
unzip train_ver2.csv.zip
cd ..
```

---

Настраиваем виртуальное окружение для Python:

```
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

---

Проводим разведочный анализ данных в ноутбуке `Exploratory_Data_Analysis.ipynb`.

---

Установка Airflow :

`sh install_airflow.sh`

Запуск Airflow :

`docker compose up --build`

Остановка Airflow :

`docker compose down`

---

Запуск MLFlow :

`mlflow server --backend-store-uri sqlite:///mlruns.db`

---

Трансляция. Выбираем метрики, на которые хотим повлиять, и рассуждаем как решать задачу.
-
Вероятнее всего это задача мультиклассовой классификации с пересекающимися классами.
Для оценки качества модели можем воспользоваться метрикой `f1-score` (или `recall` если можем позволить себе ложноположительные предсказания).
Выявление всех положительных случаев очень ценно, а ложно-положительные случаи могут создать лишнюю работу\затраты.

Предположим, что исходя из формата данных будущий сервис рекомендаций продуктов будет использоваться для каждого клиента 1 раз в месяц.

Для baseline решения просто почистим данные, закинем в randomforest или catboost. Для выборок обучения и теста стоит взять только один месяц, чтобы не было утечки данных.

Для более продвинутого решения есть разные опции:
- нагенерировать признаки (пример: динамика `renta` за последние 3 месяца);
- пропуски закодировать как отдельный признак;
- перестроить таргеты по принципу `пользователь начал пользоваться этим продуктом в следующем месяце`;

Подробнее про перестройку таргетов:
- `0 -> 1` клиент в прошлом месяце не имел вклада, а в текущем решил вложить.
- `1 -> 0` клиент перестал пользоваться определённым продуктом. Такой случай означает, что либо истек срок (как и запланировано), либо клиент досрочно отказался от продукта (что нежелательно). У нас нет информации о договорах, предполагаемых сроках предоставления услуг и т.д. Тут мы можем только гадать.
- `1 -> 1` клиент в прошлом месяце имел вклад, и в текущем месяце вклад согласно договору продолжает лежать в банке. Либо он перезаключил договор после истечения срока. Тут тоже можем только гадать.
- `0 -> 0` клиент не пользуется продуктом. 

Самый понятный и полезный случай - `0 -> 1`. Клиент начал пользоваться новым продуктом. Именно этот случай будет в таргетах равен 1.0 , остальные 0.0. Можно сместить таргет в следующий месяц, чтобы получилась интерпретация `"такое состояние клиента в начале месяца привело к покупке продукта в течение месяца"`.

---

Эксперименты в ноутбуке `experiments.ipynb`

TODO

---

...